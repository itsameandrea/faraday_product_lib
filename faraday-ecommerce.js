const button=document.querySelector("*[data-faraday-target]"),initFaradayEcommerce=async()=>{const e=async()=>{const b=await fetch("/apps/proxy/subscribers",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:p,status:q,is_dwell:r,shop_name:button.dataset.shop,product_id:button.dataset.product_id,product_title:button.dataset.product_title})});return await b.json()},l=async()=>{await fetch(`/apps/proxy/subscribers/${a}`,{method:"PATCH",headers:{"Content-type":"application/json"},body:JSON.stringify({email:p,status:q,is_dwell:r})})};let b,m,n,o,p="",q="visitor",r=!1,{id:a}=await e();(()=>{let b=0;const d=setInterval(()=>5<b?void clearInterval(d):(5==b&&(r=!0,l()),void(b+=1)),1e3)})(),button.addEventListener("click",async c=>{c.preventDefault(),c.stopPropagation(),q="active",l(),b=document.createElement("div"),n=document.createElement("input"),o=document.createElement("button"),m=document.createElement("p"),m.innerText="Sorry, we are currently out of stock of this item please signup to be notified when it comes back into stock",n.type="email",n.placeholder="your@email.com",n.id="faraday-email-input",n.style.width="100%",n.style.marginBottom="10px",o.innerText="Subscribe",o.classList.add(...Array.from(button.classList)),o.id="faraday-submit-btn",b.appendChild(m),b.appendChild(n),b.appendChild(o),button.replaceWith(b)}),document.addEventListener("click",async b=>{b.preventDefault(),p=n.value,q="subscriber",b.target&&"faraday-submit-btn"===b.target.id&&(await l(),n.value="",o.innerText="Thanks! We'll keep you posted",o.disabled=!0)})};if(!!parseInt(button.dataset.faradayEnabled)){const b=document.querySelector("*[data-faraday-hide]");b&&(b.style.display="none"),button&&initFaradayEcommerce()}