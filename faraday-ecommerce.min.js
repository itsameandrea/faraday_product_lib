const button=document.querySelector("*[data-faraday-target]");const initFaradayEcommerce=async()=>{let emai="";let status="visitor";let is_dwell=false;let{id:id}=await createSubscriber();let div,paragraph,input,submitButton;const timeUserSession=()=>{let count=0;const timer=setInterval(()=>{if(count>5){clearInterval(timer);return}if(count===5){is_dwell=true;updateSubscriber()}count+=1;return},1e3)};const createSubscriber=async()=>{const response=await fetch("/apps/proxy/subscribers",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:email,status:status,is_dwell:is_dwell,shop_name:button.dataset.shop,product_id:button.dataset.product_id,product_title:button.dataset.product_title})});return await response.json()};const updateSubscriber=async()=>{await fetch(`/apps/proxy/subscribers/${id}`,{method:"PATCH",headers:{"Content-type":"application/json"},body:JSON.stringify({email:email,status:status,is_dwell:is_dwell})})};timeUserSession();button.addEventListener("click",async e=>{e.preventDefault();e.stopPropagation();status="active";updateSubscriber();div=document.createElement("div");input=document.createElement("input");submitButton=document.createElement("button");paragraph=document.createElement("p");paragraph.innerText="Sorry, we are currently out of stock of this item please signup to be notified when it comes back into stock";input.type="email";input.placeholder="your@email.com";input.id="faraday-email-input";input.style.width="100%";input.style.marginBottom="10px";submitButton.innerText="Subscribe";submitButton.classList.add(...Array.from(button.classList));submitButton.id="faraday-submit-btn";div.appendChild(paragraph);div.appendChild(input);div.appendChild(submitButton);button.replaceWith(div)});document.addEventListener("click",async e=>{e.preventDefault();email=input.value;status="subscriber";if(e.target&&e.target.id==="faraday-submit-btn"){await updateSubscriber();input.value="";submitButton.innerText="Thanks! We'll keep you posted";submitButton.disabled=true}})};if(!!parseInt(button.dataset.faradayEnabled)){const buyNowButton=document.querySelector("*[data-faraday-hide]");if(buyNowButton){buyNowButton.style.display="none"}if(button){initFaradayEcommerce()}}4972f8352c9ddeba1f7ea8ce1a662a66ea808a5
